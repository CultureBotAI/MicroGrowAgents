{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"MicroGrowAgents","text":"<p>Agent-based system for microbial growth predictions</p> <ul> <li>Auto-generated schema documentation</li> </ul>"},{"location":"SHEET_QUERY_SYSTEM/","title":"SheetQuery System Documentation","text":"<p>Comprehensive information sheets query system for MicroGrowAgents</p>"},{"location":"SHEET_QUERY_SYSTEM/#overview","title":"Overview","text":"<p>The SheetQuery system provides powerful querying capabilities for topic-specific extended data collections stored in <code>data/sheets_*</code> directories. It enables querying TSV files and full-text publication markdown files with evidence-rich reporting.</p>"},{"location":"SHEET_QUERY_SYSTEM/#features","title":"Features","text":""},{"location":"SHEET_QUERY_SYSTEM/#4-query-types","title":"4 Query Types","text":"<ol> <li>Entity Lookup: Find entities by ID, name, or type</li> <li>Cross-Reference: Find related entities across tables and publications</li> <li>Publication Search: Full-text search within markdown publications</li> <li>Filtered Queries: SQL-like filtering on any table</li> </ol>"},{"location":"SHEET_QUERY_SYSTEM/#3-output-formats","title":"3 Output Formats","text":"<ol> <li>Markdown Tables: Formatted tables with DOI/PMID citation links</li> <li>JSON: Clean structured data for programmatic use</li> <li>Evidence Reports: Detailed reports with publication excerpts</li> </ol>"},{"location":"SHEET_QUERY_SYSTEM/#database-schema","title":"Database Schema","text":"<ul> <li>5 tables: <code>sheet_collections</code>, <code>sheet_tables</code>, <code>sheet_data</code>, <code>sheet_publications</code>, <code>sheet_publication_references</code></li> <li>9 strategic indexes: Optimized for all query types</li> <li>EAV pattern: Flexible JSON storage for variable schemas</li> <li>Auto-increment IDs: Using DuckDB sequences</li> </ul>"},{"location":"SHEET_QUERY_SYSTEM/#quick-start","title":"Quick Start","text":""},{"location":"SHEET_QUERY_SYSTEM/#1-initialize-schema","title":"1. Initialize Schema","text":"<pre><code># Schema is automatically created when loading data\nuv run python scripts/init_sheet_schema.py --database data/processed/microgrow.duckdb\n</code></pre>"},{"location":"SHEET_QUERY_SYSTEM/#2-load-data","title":"2. Load Data","text":"<pre><code># Load CMM collection\nuv run python scripts/load_sheets.py \\\n    --collection-id cmm \\\n    --sheets-dir data/sheets_cmm \\\n    --validate\n\n# Expected output:\n# Tables Loaded: 17\n# Publications: 118\n# Total Rows: 1,763\n# References Created: 200+\n</code></pre>"},{"location":"SHEET_QUERY_SYSTEM/#3-query-data","title":"3. Query Data","text":""},{"location":"SHEET_QUERY_SYSTEM/#python-api-agent","title":"Python API (Agent)","text":"<pre><code>from microgrowagents.agents.sheet_query_agent import SheetQueryAgent\n\nagent = SheetQueryAgent()\n\n# Entity lookup\nresult = agent.entity_lookup(\n    query=\"lookup europium\",\n    collection_id=\"cmm\",\n    entity_id=\"CHEBI:52927\"\n)\n\n# Cross-reference\nresult = agent.cross_reference_query(\n    query=\"find genes related to europium\",\n    collection_id=\"cmm\",\n    source_entity_id=\"CHEBI:52927\",\n    include_types=[\"gene\"]\n)\n\n# Publication search\nresult = agent.publication_search(\n    query=\"search for lanthanide studies\",\n    collection_id=\"cmm\",\n    keyword=\"lanthanide\",\n    include_excerpts=True\n)\n\n# Filtered query\nresult = agent.filtered_query(\n    query=\"filter chemicals by formula\",\n    collection_id=\"cmm\",\n    table_name=\"chemicals\",\n    filter_conditions={\"molecular_formula\": \"Eu3+\"}\n)\n</code></pre>"},{"location":"SHEET_QUERY_SYSTEM/#python-api-skill","title":"Python API (Skill)","text":"<pre><code>from microgrowagents.skills.simple.sheet_query import SheetQuerySkill\n\nskill = SheetQuerySkill()\n\n# Markdown output\nresult = skill.run(\n    collection_id=\"cmm\",\n    query_type=\"entity_lookup\",\n    entity_id=\"CHEBI:52927\",\n    output_format=\"markdown\"\n)\nprint(result)\n\n# JSON output\nresult = skill.run(\n    collection_id=\"cmm\",\n    query_type=\"publication_search\",\n    keyword=\"europium\",\n    output_format=\"json\"\n)\nimport json\ndata = json.loads(result)\n\n# Evidence report\nresult = skill.run(\n    collection_id=\"cmm\",\n    query_type=\"cross_reference\",\n    source_entity_id=\"K23995\",\n    output_format=\"evidence_report\"\n)\nprint(result)\n</code></pre>"},{"location":"SHEET_QUERY_SYSTEM/#architecture","title":"Architecture","text":""},{"location":"SHEET_QUERY_SYSTEM/#component-overview","title":"Component Overview","text":"<pre><code>SheetQuery System\n\u251c\u2500\u2500 Database Layer\n\u2502   \u251c\u2500\u2500 schema.py           # 5 tables + 9 indexes\n\u2502   \u251c\u2500\u2500 sheet_loader.py     # TSV + publication loading (661 lines)\n\u2502   \u2514\u2500\u2500 init_sheet_schema.py # Schema initialization script\n\u2502\n\u251c\u2500\u2500 Agent Layer\n\u2502   \u2514\u2500\u2500 sheet_query_agent.py  # 4 query types (655 lines)\n\u2502\n\u251c\u2500\u2500 Skill Layer\n\u2502   \u2514\u2500\u2500 sheet_query.py        # 3 output formatters (541 lines)\n\u2502\n\u2514\u2500\u2500 Scripts\n    \u2514\u2500\u2500 load_sheets.py        # Data loading script (157 lines)\n</code></pre>"},{"location":"SHEET_QUERY_SYSTEM/#data-flow","title":"Data Flow","text":"<pre><code>1. Loading:\n   TSV Files + Publications \u2192 SheetDataLoader \u2192 DuckDB (5 tables)\n\n2. Querying:\n   User Query \u2192 SheetQuerySkill \u2192 SheetQueryAgent \u2192 DuckDB\n              \u2192 Format (MD/JSON/Report) \u2192 User\n\n3. Cross-References:\n   Entity \u2192 extract FK IDs \u2192 match publications \u2192 link via sheet_publication_references\n</code></pre>"},{"location":"SHEET_QUERY_SYSTEM/#database-schema-details","title":"Database Schema Details","text":""},{"location":"SHEET_QUERY_SYSTEM/#table-1-sheet_collections","title":"Table 1: sheet_collections","text":"<p>Collection metadata registry</p> <pre><code>collection_id VARCHAR PRIMARY KEY    -- 'cmm', 'xyz'\ncollection_name VARCHAR NOT NULL     -- 'CMM Extended Data'\ndirectory_path VARCHAR NOT NULL      -- 'data/sheets_cmm'\nloaded_at TIMESTAMP\ntable_count INTEGER\ntotal_rows INTEGER\n</code></pre>"},{"location":"SHEET_QUERY_SYSTEM/#table-2-sheet_tables","title":"Table 2: sheet_tables","text":"<p>Table registry for each collection</p> <pre><code>table_id VARCHAR PRIMARY KEY         -- 'cmm_chemicals'\ncollection_id VARCHAR NOT NULL       -- FK to sheet_collections\ntable_name VARCHAR NOT NULL          -- 'chemicals'\nsource_file VARCHAR NOT NULL         -- 'BER_CMM_..._chemicals_extended.tsv'\nrow_count INTEGER\ncolumn_count INTEGER\ncolumns_json TEXT                    -- JSON array of column names\n</code></pre>"},{"location":"SHEET_QUERY_SYSTEM/#table-3-sheet_data","title":"Table 3: sheet_data","text":"<p>Unified entity storage (EAV pattern)</p> <pre><code>id INTEGER PRIMARY KEY              -- Auto-increment via sequence\ntable_id VARCHAR NOT NULL           -- FK to sheet_tables\nentity_id VARCHAR                   -- Primary ID (CHEBI:52927, K23995, etc.)\nentity_name VARCHAR                 -- Primary name\nentity_type VARCHAR                 -- 'chemical', 'gene', 'strain', etc.\ndata_json TEXT NOT NULL             -- Complete row as JSON\nsearchable_text TEXT                -- Concatenated text for full-text search\n</code></pre>"},{"location":"SHEET_QUERY_SYSTEM/#table-4-sheet_publications","title":"Table 4: sheet_publications","text":"<p>Publication full-text index</p> <pre><code>id INTEGER PRIMARY KEY              -- Auto-increment\ncollection_id VARCHAR NOT NULL      -- FK to sheet_collections\nfile_name VARCHAR NOT NULL          -- 'PMID_24816778.md'\npublication_id VARCHAR              -- 'pmid:24816778', 'doi:10.1038/...'\npublication_type VARCHAR            -- 'pmid', 'doi', 'pmc'\ntitle TEXT\nfull_text TEXT                      -- Complete markdown content\nword_count INTEGER\n</code></pre>"},{"location":"SHEET_QUERY_SYSTEM/#table-5-sheet_publication_references","title":"Table 5: sheet_publication_references","text":"<p>Cross-references between entities and publications</p> <pre><code>id INTEGER PRIMARY KEY              -- Auto-increment\npublication_id INTEGER NOT NULL     -- FK to sheet_publications.id\ntable_id VARCHAR NOT NULL           -- FK to sheet_tables\nentity_id VARCHAR NOT NULL          -- Entity referencing publication\nreference_column VARCHAR            -- Column where reference appears (URL, DOI)\nreference_value VARCHAR             -- Actual reference value\n</code></pre>"},{"location":"SHEET_QUERY_SYSTEM/#indexes-9-total","title":"Indexes (9 total)","text":"<p>Entity Lookup (Query Type 1): - <code>idx_sheet_data_entity_id</code> - Fast ID lookups - <code>idx_sheet_data_entity_name</code> - Name-based searches - <code>idx_sheet_data_entity_type</code> - Type filtering</p> <p>Cross-Reference (Query Type 2): - <code>idx_sheet_data_composite</code> - (table_id, entity_type) compound index - <code>idx_sheet_pub_refs_entity</code> - Entity\u2192Publication links</p> <p>Publication Search (Query Type 3): - <code>idx_sheet_pubs_pub_id</code> - Publication ID lookups - <code>idx_sheet_data_searchable</code> - Full-text search</p> <p>Filtered Queries (Query Type 4): - <code>idx_sheet_tables_collection</code> - Collection-based filtering - <code>idx_sheet_data_table</code> - Table-based filtering</p>"},{"location":"SHEET_QUERY_SYSTEM/#query-types-in-detail","title":"Query Types in Detail","text":""},{"location":"SHEET_QUERY_SYSTEM/#1-entity-lookup","title":"1. Entity Lookup","text":"<p>Purpose: Find entities by ID, name, or type</p> <p>Parameters: - <code>collection_id</code> (required): Collection to search - <code>entity_id</code> (optional): Exact ID match - <code>entity_name</code> (optional): Name match (exact or partial) - <code>entity_type</code> (optional): Filter by type - <code>exact_match</code> (optional): Boolean for partial name matching</p> <p>Example:</p> <pre><code># By ID\nresult = agent.entity_lookup(\n    query=\"lookup\",\n    collection_id=\"cmm\",\n    entity_id=\"CHEBI:52927\"\n)\n\n# By name (partial)\nresult = agent.entity_lookup(\n    query=\"find lanthanide\",\n    collection_id=\"cmm\",\n    entity_name=\"lanthanide\",\n    exact_match=False\n)\n\n# By type\nresult = agent.entity_lookup(\n    query=\"all chemicals\",\n    collection_id=\"cmm\",\n    entity_type=\"chemical\"\n)\n</code></pre> <p>Returns:</p> <pre><code>{\n  \"success\": true,\n  \"data\": {\n    \"entities\": [{\n      \"entity_id\": \"CHEBI:52927\",\n      \"entity_name\": \"Europium(III) cation\",\n      \"entity_type\": \"chemical\",\n      \"properties\": {\n        \"chemical_id\": \"CHEBI:52927\",\n        \"molecular_formula\": \"Eu3+\",\n        \"molecular_weight\": \"151.964\",\n        \"role\": \"TRL probe\"\n      }\n    }]\n  }\n}\n</code></pre>"},{"location":"SHEET_QUERY_SYSTEM/#2-cross-reference-query","title":"2. Cross-Reference Query","text":"<p>Purpose: Find entities related to a source entity and its publications</p> <p>Strategy: 1. Retrieve source entity 2. Extract foreign key IDs from data_json (CHEBI, GO, KEGG, etc.) 3. Find entities with matching IDs 4. Search for entities referencing the source 5. Retrieve linked publications</p> <p>Parameters: - <code>collection_id</code> (required) - <code>source_entity_id</code> (required) - <code>include_types</code> (optional): Filter related entities by type</p> <p>Example:</p> <pre><code>result = agent.cross_reference_query(\n    query=\"find entities related to XoxF\",\n    collection_id=\"cmm\",\n    source_entity_id=\"K23995\",\n    include_types=[\"chemical\", \"pathway\"]\n)\n</code></pre> <p>Returns:</p> <pre><code>{\n  \"success\": true,\n  \"data\": {\n    \"source_entity\": {\n      \"entity_id\": \"K23995\",\n      \"entity_name\": \"XoxF methanol dehydrogenase\",\n      \"entity_type\": \"gene\"\n    },\n    \"related_entities\": [\n      {\n        \"entity_id\": \"CHEBI:52927\",\n        \"entity_name\": \"Europium(III) cation\",\n        \"entity_type\": \"chemical\",\n        \"relationship\": \"referenced_by_source\"\n      }\n    ],\n    \"publications\": [\n      {\n        \"publication_id\": \"pmid:24816778\",\n        \"publication_type\": \"pmid\",\n        \"title\": \"Chemistry of Lanthanides...\"\n      }\n    ]\n  }\n}\n</code></pre>"},{"location":"SHEET_QUERY_SYSTEM/#3-publication-search","title":"3. Publication Search","text":"<p>Purpose: Full-text search within publication markdown files</p> <p>Parameters: - <code>collection_id</code> (required) - <code>keyword</code> or <code>keywords</code> (required): Search term(s) - <code>max_results</code> (optional): Limit results (default: 50) - <code>include_excerpts</code> (optional): Include text excerpts (default: True)</p> <p>Example:</p> <pre><code>result = agent.publication_search(\n    query=\"search for europium studies\",\n    collection_id=\"cmm\",\n    keyword=\"europium\",\n    include_excerpts=True,\n    max_results=10\n)\n</code></pre> <p>Returns:</p> <pre><code>{\n  \"success\": true,\n  \"data\": {\n    \"publications\": [\n      {\n        \"publication_id\": \"pmid:24816778\",\n        \"publication_type\": \"pmid\",\n        \"full_text\": \"...\",\n        \"excerpt\": \"...lanthanides such as **europium** have emerged...\",\n        \"entity_count\": 5\n      }\n    ]\n  }\n}\n</code></pre>"},{"location":"SHEET_QUERY_SYSTEM/#4-filtered-query","title":"4. Filtered Query","text":"<p>Purpose: SQL-like filtering on tables with JSON path extraction</p> <p>Supported Operators: - Equality: <code>{\"property\": \"value\"}</code> - Contains: <code>{\"property\": {\"$contains\": \"substring\"}}</code></p> <p>Parameters: - <code>collection_id</code> (required) - <code>table_name</code> (optional): Specific table to filter - <code>entity_type</code> (optional): Filter by entity type - <code>filter_conditions</code> (optional): Dict of property filters</p> <p>Example:</p> <pre><code># Simple equality\nresult = agent.filtered_query(\n    query=\"filter by formula\",\n    collection_id=\"cmm\",\n    table_name=\"chemicals\",\n    filter_conditions={\"molecular_formula\": \"Eu3+\"}\n)\n\n# Contains operator\nresult = agent.filtered_query(\n    query=\"filter genes\",\n    collection_id=\"cmm\",\n    table_name=\"genes_and_proteins\",\n    filter_conditions={\n        \"annotation\": {\"$contains\": \"dehydrogenase\"}\n    }\n)\n\n# Multiple conditions (AND logic)\nresult = agent.filtered_query(\n    query=\"filter\",\n    collection_id=\"cmm\",\n    table_name=\"genes_and_proteins\",\n    filter_conditions={\n        \"organism\": \"NCBITaxon:469\",\n        \"annotation\": {\"$contains\": \"methanol\"}\n    }\n)\n</code></pre>"},{"location":"SHEET_QUERY_SYSTEM/#output-formats","title":"Output Formats","text":""},{"location":"SHEET_QUERY_SYSTEM/#1-markdown-tables","title":"1. Markdown Tables","text":"<p>Best for: Human-readable reports, documentation</p> <p>Features: - Formatted tables with pipe delimiters - Clickable DOI/PMID citation links - Limited to 50 entities per table for readability - Includes section headers</p> <p>Example:</p> <pre><code># Sheet Query Results: cmm\n\n## Entities (5 found)\n\n| ID | Name | Type | Properties |\n|----|------|------|------------|\n| CHEBI:52927 | Europium(III) cation | chemical | formula: Eu3+, MW: 151.964 |\n\n## Publications (2 found)\n\n### 1. [PMID:24816778](https://pubmed.ncbi.nlm.nih.gov/24816778/)\n\n**Excerpt**: ...lanthanides such as **europium** have emerged...\n</code></pre>"},{"location":"SHEET_QUERY_SYSTEM/#2-json","title":"2. JSON","text":"<p>Best for: Programmatic access, data pipelines</p> <p>Features: - Valid JSON with full data structures - Includes execution metadata - No data truncation</p> <p>Example:</p> <pre><code>{\n  \"success\": true,\n  \"data\": {\n    \"entities\": [\n      {\n        \"entity_id\": \"CHEBI:52927\",\n        \"entity_name\": \"Europium(III) cation\",\n        \"entity_type\": \"chemical\",\n        \"properties\": {\n          \"chemical_id\": \"CHEBI:52927\",\n          \"molecular_formula\": \"Eu3+\",\n          \"molecular_weight\": \"151.964\"\n        }\n      }\n    ],\n    \"count\": 1\n  },\n  \"metadata\": {\n    \"query\": \"lookup chemical\",\n    \"collection_id\": \"cmm\",\n    \"execution_time\": 0.05\n  }\n}\n</code></pre>"},{"location":"SHEET_QUERY_SYSTEM/#3-evidence-reports","title":"3. Evidence Reports","text":"<p>Best for: Detailed analysis, research reports</p> <p>Features: - Comprehensive entity details - Grouped related entities by type - Publication excerpts with context - Structured sections with headers - Publication links</p> <p>Example:</p> <pre><code># Evidence Report: cmm\n\n## Entity Details\n\n**Chemical**: Europium(III) cation\n\n**ID**: CHEBI:52927\n\n### Properties\n\n- **molecular_formula**: Eu3+\n- **molecular_weight**: 151.964\n- **role**: TRL assay probe\n\n## Related Entities (3)\n\n### Genes (2)\n\n- **K23995**: XoxF methanol dehydrogenase\n  - *referenced_by_source*\n- **custom_xoxF_ma**: Lanthanide-dependent methanol dehydrogenase\n\n## Publication Evidence\n\n### 1. PMID:24816778\n\n[View on PubMed](https://pubmed.ncbi.nlm.nih.gov/24816778/)\n\n&gt; Lanthanides such as **europium** and **terbium** have emerged\n&gt; as essential cofactors for bacterial enzymes involved in\n&gt; methanol metabolism...\n\n**Referenced by**: 5 entities in this collection\n</code></pre>"},{"location":"SHEET_QUERY_SYSTEM/#testing","title":"Testing","text":""},{"location":"SHEET_QUERY_SYSTEM/#test-coverage-9191-tests-passing-100","title":"Test Coverage: 91/91 tests passing (100%)","text":"<p>Schema Tests (8 tests): - Table creation - Index creation - Data insertion - Constraint validation</p> <p>Loader Tests (20 tests): - TSV loading - Publication loading - Entity type inference - Publication ID extraction - Cross-reference building - Error handling</p> <p>Agent Tests (27 tests): - Entity lookup (7 tests) - Cross-reference (3 tests) - Publication search (5 tests) - Filtered queries (5 tests) - Query routing (5 tests) - Error handling (2 tests)</p> <p>Skill Tests (22 tests): - Markdown output (3 tests) - JSON output (3 tests) - Evidence reports (3 tests) - All query types (4 tests) - Parameter validation (3 tests) - Output switching (1 test)</p> <p>Integration Tests (14 tests): - End-to-end workflow - Data integrity - Publication citations - Multiple collections - Query performance - Error recovery - Output formats - Data validation</p>"},{"location":"SHEET_QUERY_SYSTEM/#running-tests","title":"Running Tests","text":"<pre><code># All SheetQuery tests\nuv run pytest tests/test_database/test_sheet_schema.py \\\n             tests/test_database/test_sheet_loader.py \\\n             tests/test_agents/test_sheet_query_agent.py \\\n             tests/test_skills/test_sheet_query_skill.py \\\n             tests/integration/test_sheet_query_integration.py -v\n\n# Specific test categories\nuv run pytest tests/test_database/test_sheet_loader.py -v  # Loader only\nuv run pytest tests/test_agents/test_sheet_query_agent.py -v  # Agent only\nuv run pytest tests/integration/ -v  # Integration only\n</code></pre>"},{"location":"SHEET_QUERY_SYSTEM/#performance","title":"Performance","text":""},{"location":"SHEET_QUERY_SYSTEM/#query-performance-benchmarks","title":"Query Performance Benchmarks","text":"<p>Entity Lookup by ID: &lt; 100ms (indexed) Cross-Reference Query: &lt; 500ms Publication Search: &lt; 1 second Filtered Query: &lt; 200ms</p>"},{"location":"SHEET_QUERY_SYSTEM/#loading-performance","title":"Loading Performance","text":"<p>CMM Collection (17 TSV + 118 publications): - Loading time: ~30 seconds - Total rows: 1,763 - Database size: ~15 MB</p>"},{"location":"SHEET_QUERY_SYSTEM/#optimization-features","title":"Optimization Features","text":"<ol> <li>Strategic Indexes: 9 indexes optimized for specific query patterns</li> <li>Batch Inserts: 1000 rows per INSERT during loading</li> <li>JSON Storage: Flexible schema without complex migrations</li> <li>Connection Pooling: Reuse database connections</li> </ol>"},{"location":"SHEET_QUERY_SYSTEM/#troubleshooting","title":"Troubleshooting","text":""},{"location":"SHEET_QUERY_SYSTEM/#common-issues","title":"Common Issues","text":"<p>Issue: \"Table does not exist\" error Solution: Run <code>scripts/init_sheet_schema.py</code> or load data with <code>--validate</code> flag</p> <p>Issue: \"Collection not found\" Solution: Verify collection_id matches loaded collection name</p> <p>Issue: \"Slow queries\" Solution: Ensure indexes exist (<code>SHOW INDEXES</code> in DuckDB)</p> <p>Issue: \"Connection error\" Solution: Ensure no stale connections; loader auto-closes after operations</p>"},{"location":"SHEET_QUERY_SYSTEM/#debugging","title":"Debugging","text":"<pre><code># Enable debug logging\nimport logging\nlogging.basicConfig(level=logging.DEBUG)\n\n# Check loaded collections\nconn = duckdb.connect(\"data/processed/microgrow.duckdb\")\nconn.execute(\"SELECT * FROM sheet_collections\").fetchall()\n\n# Check table counts\nconn.execute(\"\"\"\n    SELECT collection_id, table_name, row_count\n    FROM sheet_tables\n    ORDER BY collection_id, table_name\n\"\"\").fetchall()\n\n# Check indexes\nconn.execute(\"SHOW INDEXES\").fetchall()\n</code></pre>"},{"location":"SHEET_QUERY_SYSTEM/#future-enhancements","title":"Future Enhancements","text":"<p>Potential improvements: 1. Query Language: Natural language query parsing 2. Advanced Filters: Greater-than, less-than, IN operators 3. Aggregations: COUNT, GROUP BY on entity properties 4. Export: Direct export to CSV, Excel, PDF 5. Caching: Query result caching for frequent searches 6. Fuzzy Search: Approximate string matching for entity names</p>"},{"location":"SHEET_QUERY_SYSTEM/#license","title":"License","text":"<p>Part of MicroGrowAgents project.</p>"},{"location":"SHEET_QUERY_SYSTEM/#support","title":"Support","text":"<p>For issues or questions: - GitHub Issues: https://github.com/monarch-initiative/MicroGrowAgents/issues - Documentation: <code>docs/</code></p>"},{"location":"about/","title":"About MicroGrowAgents","text":"<p>Agent-based system for microbial growth predictions</p>"},{"location":"grape_installation/","title":"GRAPE Installation Guide","text":"<p>This guide provides detailed instructions for installing GRAPE (Graph Representation leArning, Predictions and Evaluations) for use with MicroGrowAgents' KG reasoning capabilities.</p>"},{"location":"grape_installation/#what-is-grape","title":"What is GRAPE?","text":"<p>GRAPE is a high-performance graph analysis library developed by AnacletoLAB with a Rust backend (ensmallen) that provides:</p> <ul> <li>10-100x faster graph algorithms compared to NetworkX</li> <li>Memory efficient: ~800MB vs ~2GB for 5M edge graphs</li> <li>Direct TSV loading: 5-15s vs 60s for large graphs</li> <li>Parallel algorithms: Optimized for biological networks</li> <li>Built-in embeddings: Node2Vec, DeepWalk, etc.</li> </ul> <p>Repository: https://github.com/AnacletoLAB/grape</p>"},{"location":"grape_installation/#platform-support","title":"Platform Support","text":""},{"location":"grape_installation/#fully-supported-pre-built-wheels-available","title":"\u2705 Fully Supported (Pre-built Wheels Available)","text":"<ul> <li>Linux x86_64 (Ubuntu, CentOS, Debian, etc.)</li> <li>Python 3.8, 3.9, 3.10, 3.11</li> <li> <p>Recommended: Ubuntu 20.04+ or CentOS 7+</p> </li> <li> <p>Windows x86_64 (limited support)</p> </li> <li>Python 3.8, 3.9, 3.10</li> <li>Requires Visual C++ Build Tools</li> </ul>"},{"location":"grape_installation/#partial-support-requires-compilation","title":"\u26a0\ufe0f Partial Support (Requires Compilation)","text":"<ul> <li>macOS ARM64 (Apple Silicon M1/M2/M3)</li> <li>Requires Rust toolchain</li> <li>May have compilation issues with Python 3.11+</li> <li> <p>Workaround: Use Conda or Rosetta 2</p> </li> <li> <p>macOS x86_64 (Intel)</p> </li> <li>Requires Rust toolchain</li> <li>Better success rate than ARM64</li> </ul>"},{"location":"grape_installation/#not-supported","title":"\u274c Not Supported","text":"<ul> <li>Python 3.12+ (as of GRAPE 0.2.5)</li> <li>32-bit systems</li> <li>BSD systems</li> </ul>"},{"location":"grape_installation/#installation-methods","title":"Installation Methods","text":""},{"location":"grape_installation/#method-1-pip-install-easiest-for-supported-platforms","title":"Method 1: pip install (Easiest - For Supported Platforms)","text":"<pre><code># Standard installation (uses pre-built wheels if available)\npip install grape\n\n# Or with uv (recommended)\nuv pip install grape\n\n# Verify installation\npython -c \"from grape import Graph; print('GRAPE installed successfully')\"\n</code></pre> <p>Expected output:</p> <pre><code>GRAPE installed successfully\n</code></pre> <p>If you see <code>ImportError: cannot import name 'ensmallen_default'</code>, proceed to Method 2 or 3.</p>"},{"location":"grape_installation/#method-2-conda-recommended-for-macos","title":"Method 2: Conda (Recommended for macOS)","text":"<p>Conda provides pre-built binaries for more platform combinations:</p> <pre><code># Create a new conda environment (recommended)\nconda create -n microgrow python=3.10\nconda activate microgrow\n\n# Install GRAPE from conda-forge\nconda install -c conda-forge grape\n\n# Verify installation\npython -c \"from grape import Graph; print('GRAPE installed successfully')\"\n</code></pre> <p>Advantages: - Pre-built for macOS ARM64 and x86_64 - Handles Rust dependencies automatically - Better platform compatibility</p>"},{"location":"grape_installation/#method-3-build-from-source-for-unsupported-platforms","title":"Method 3: Build from Source (For Unsupported Platforms)","text":"<p>If pre-built wheels are not available, you can compile from source:</p>"},{"location":"grape_installation/#prerequisites","title":"Prerequisites","text":"<p>1. Install Rust toolchain:</p> <pre><code># macOS and Linux\ncurl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh\nsource $HOME/.cargo/env\n\n# Verify Rust installation\nrustc --version\ncargo --version\n</code></pre> <p>2. Install build dependencies:</p> <pre><code># macOS\nxcode-select --install\n\n# Ubuntu/Debian\nsudo apt-get update\nsudo apt-get install build-essential python3-dev\n\n# CentOS/RHEL\nsudo yum groupinstall \"Development Tools\"\nsudo yum install python3-devel\n</code></pre>"},{"location":"grape_installation/#compile-and-install","title":"Compile and Install","text":"<pre><code># Build from source (no pre-built wheels)\npip install --no-binary grape,ensmallen grape\n\n# This will take 10-30 minutes\n# Expected output:\n#   Building wheels for collected packages: ensmallen, grape\n#   Building wheel for ensmallen (setup.py) ... (this is slow)\n</code></pre> <p>Troubleshooting compilation:</p> <p>If compilation fails with \"cargo build failed\":</p> <pre><code># Try with more memory allocated to Rust\nexport CARGO_BUILD_JOBS=2  # Reduce parallel jobs\npip install --no-binary grape,ensmallen grape\n\n# Or build ensmallen separately\npip install --no-binary ensmallen ensmallen\npip install grape\n</code></pre>"},{"location":"grape_installation/#method-4-rosetta-2-macos-arm64-workaround","title":"Method 4: Rosetta 2 (macOS ARM64 Workaround)","text":"<p>For Apple Silicon Macs, you can run x86_64 Python under Rosetta 2:</p> <pre><code># Install x86_64 Python using pyenv\narch -x86_64 /bin/bash -c \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\"\narch -x86_64 brew install python@3.10\n\n# Create x86_64 virtual environment\narch -x86_64 /usr/local/bin/python3.10 -m venv .venv-x86\nsource .venv-x86/bin/activate\n\n# Install GRAPE (will use x86_64 wheels)\npip install grape\n\n# Verify\npython -c \"from grape import Graph; print('GRAPE installed (x86_64 mode)')\"\n</code></pre>"},{"location":"grape_installation/#verifying-grape-installation","title":"Verifying GRAPE Installation","text":""},{"location":"grape_installation/#basic-import-test","title":"Basic Import Test","text":"<pre><code>from grape import Graph\nprint(f\"GRAPE version: {Graph.__module__}\")\n</code></pre>"},{"location":"grape_installation/#create-test-graph","title":"Create Test Graph","text":"<pre><code>from grape import Graph\nimport tempfile\nfrom pathlib import Path\n\n# Create test data\nnodes_data = \"\"\"id\\ttype\nA\\ttype1\nB\\ttype1\nC\\ttype2\n\"\"\"\n\nedges_data = \"\"\"source\\tdestination\\ttype\nA\\tB\\trelates_to\nB\\tC\\trelates_to\n\"\"\"\n\n# Write to temporary files\nwith tempfile.NamedTemporaryFile(mode='w', suffix='.tsv', delete=False) as f:\n    f.write(nodes_data)\n    nodes_file = f.name\n\nwith tempfile.NamedTemporaryFile(mode='w', suffix='.tsv', delete=False) as f:\n    f.write(edges_data)\n    edges_file = f.name\n\n# Load graph\ngraph = Graph.from_csv(\n    directed=True,\n    edge_path=edges_file,\n    edge_list_separator='\\t',\n    edge_list_header=True,\n    sources_column='source',\n    destinations_column='destination',\n    node_path=nodes_file,\n    node_list_separator='\\t',\n    node_list_header=True,\n    nodes_column='id',\n    name='test_graph'\n)\n\nprint(f\"Nodes: {graph.get_number_of_nodes()}\")\nprint(f\"Edges: {graph.get_number_of_edges()}\")\nprint(\"\u2713 GRAPE working correctly!\")\n\n# Cleanup\nPath(nodes_file).unlink()\nPath(edges_file).unlink()\n</code></pre> <p>Expected output:</p> <pre><code>Nodes: 3\nEdges: 2\n\u2713 GRAPE working correctly!\n</code></pre>"},{"location":"grape_installation/#common-installation-issues","title":"Common Installation Issues","text":""},{"location":"grape_installation/#issue-1-importerror-cannot-import-name-ensmallen_default","title":"Issue 1: <code>ImportError: cannot import name 'ensmallen_default'</code>","text":"<p>Symptom:</p> <pre><code>from grape import Graph\n# ImportError: cannot import name 'ensmallen_default' from partially initialized module 'ensmallen'\n</code></pre> <p>Cause: Ensmallen Rust module didn't compile or isn't compatible with your Python version.</p> <p>Solutions: 1. Check Python version: <code>python --version</code> (must be \u22643.11) 2. Try Conda installation (Method 2) 3. Build from source (Method 3) 4. Use Rosetta 2 on ARM64 Mac (Method 4)</p>"},{"location":"grape_installation/#issue-2-modulenotfounderror-no-module-named-grape","title":"Issue 2: <code>ModuleNotFoundError: No module named 'grape'</code>","text":"<p>Solution:</p> <pre><code># Ensure grape is installed in active environment\npip list | grep grape\n\n# If not found, install\npip install grape\n</code></pre>"},{"location":"grape_installation/#issue-3-compilation-fails-with-cargo-build-failed","title":"Issue 3: Compilation fails with \"cargo build failed\"","text":"<p>Symptoms:</p> <pre><code>error: could not compile `ensmallen`\ncargo build failed\n</code></pre> <p>Solutions:</p> <ol> <li> <p>Reduce parallel jobs:    <code>bash    export CARGO_BUILD_JOBS=2    pip install --no-binary grape,ensmallen grape</code></p> </li> <li> <p>Install older Rust:    <code>bash    rustup install 1.70.0    rustup default 1.70.0    pip install --no-binary grape,ensmallen grape</code></p> </li> <li> <p>Use Conda instead (recommended)</p> </li> </ol>"},{"location":"grape_installation/#issue-4-arm64-macos-specific-issues","title":"Issue 4: ARM64 macOS specific issues","text":"<p>Problem: Pre-built wheels not available for ARM64 + Python 3.11</p> <p>Best solution: Use Conda</p> <pre><code>conda create -n microgrow python=3.10\nconda activate microgrow\nconda install -c conda-forge grape\n</code></pre> <p>Alternative: Use Rosetta 2 (Method 4)</p>"},{"location":"grape_installation/#testing-grape-with-kg-microbe","title":"Testing GRAPE with KG-Microbe","text":"<p>Once GRAPE is installed, test with MicroGrowAgents:</p> <pre><code># Run graph builder tests\nuv run pytest tests/test_kg/test_graph_builder.py -v\n\n# If GRAPE is working, all tests should pass\n# If not installed, tests will skip with helpful messages\n</code></pre>"},{"location":"grape_installation/#quick-test-script","title":"Quick Test Script","text":"<pre><code>from microgrowagents.kg.graph_builder import GraphBuilder, GRAPE_AVAILABLE\n\nif GRAPE_AVAILABLE:\n    print(\"\u2713 GRAPE is available and ready!\")\n    print(\"  You can use high-performance graph algorithms.\")\nelse:\n    print(\"\u26a0 GRAPE is not available on this system.\")\n    print(\"  Graph builder will use fallback mode.\")\n    print(\"  See docs/grape_installation.md for installation help.\")\n</code></pre>"},{"location":"grape_installation/#performance-benchmarks","title":"Performance Benchmarks","text":"<p>Comparison of GRAPE vs NetworkX on KG-Microbe (1.5M nodes, 5.1M edges):</p> Operation NetworkX GRAPE Speedup Graph loading 60-120s 5-15s 8-24x Memory usage ~2GB ~800MB 2.5x less Shortest path 800ms 8-80ms 10-100x Betweenness centrality 180s 3.6s 50x PageRank 45s 2.3s 20x <p>Note: Benchmarks on Ubuntu 20.04 x86_64 with Python 3.10</p>"},{"location":"grape_installation/#fallback-option-networkx","title":"Fallback Option: NetworkX","text":"<p>If GRAPE cannot be installed, MicroGrowAgents provides automatic fallback to NetworkX:</p> <pre><code># This will work even without GRAPE\nfrom microgrowagents.kg.graph_builder import GraphBuilder\n\nbuilder = GraphBuilder(db_path)\n# Will use NetworkX if GRAPE unavailable (with warning)\n</code></pre> <p>Trade-offs: - \u2705 Pure Python (no compilation needed) - \u2705 Works on all platforms - \u274c 10-100x slower for large graphs - \u274c Higher memory usage (~2GB for KG-Microbe)</p>"},{"location":"grape_installation/#recommended-setup-by-platform","title":"Recommended Setup by Platform","text":""},{"location":"grape_installation/#ubuntudebian-linux-x86_64","title":"Ubuntu/Debian Linux (x86_64)","text":"<pre><code># Easiest - pre-built wheels available\npip install grape\n</code></pre>"},{"location":"grape_installation/#centosrhel-linux-x86_64","title":"CentOS/RHEL Linux (x86_64)","text":"<pre><code># Pre-built wheels available\npip install grape\n</code></pre>"},{"location":"grape_installation/#macos-arm64-m1m2m3","title":"macOS ARM64 (M1/M2/M3)","text":"<pre><code># Use Conda (recommended)\nconda install -c conda-forge grape\n\n# OR use Rosetta 2\narch -x86_64 python3.10 -m venv .venv-x86\nsource .venv-x86/bin/activate\npip install grape\n</code></pre>"},{"location":"grape_installation/#macos-intel-x86_64","title":"macOS Intel (x86_64)","text":"<pre><code># Conda recommended\nconda install -c conda-forge grape\n\n# Or build from source\npip install --no-binary grape grape\n</code></pre>"},{"location":"grape_installation/#windows-x86_64","title":"Windows x86_64","text":"<pre><code># Install Visual C++ Build Tools first\n# https://visualstudio.microsoft.com/downloads/#build-tools-for-visual-studio-2019\n\npip install grape\n</code></pre>"},{"location":"grape_installation/#support-and-resources","title":"Support and Resources","text":"<ul> <li>GRAPE GitHub: https://github.com/AnacletoLAB/grape</li> <li>Documentation: https://anacletolab.github.io/grape/</li> <li>Issues: https://github.com/AnacletoLAB/grape/issues</li> <li>Paper: Cappelletti et al., \"GRAPE: fast and scalable Graph Processing and Embedding\"</li> </ul>"},{"location":"grape_installation/#contact","title":"Contact","text":"<p>For MicroGrowAgents-specific GRAPE issues: - Open an issue on the MicroGrowAgents repository - Include: OS, Python version, GRAPE installation method, error message</p>"},{"location":"grape_installation/#quick-reference","title":"Quick Reference","text":"<pre><code># Check if GRAPE is installed\npython -c \"from grape import Graph; print('\u2713 GRAPE OK')\"\n\n# Check Python version (must be \u22643.11)\npython --version\n\n# Check system architecture\nuname -m\n\n# Install GRAPE (Linux x86_64)\npip install grape\n\n# Install GRAPE (macOS, any arch)\nconda install -c conda-forge grape\n\n# Build from source\npip install --no-binary grape,ensmallen grape\n\n# Test with MicroGrowAgents\nuv run pytest tests/test_kg/test_graph_builder.py -v\n</code></pre>"}]}